<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Veyra — Proof</title>
<link rel="icon" href="/public/favicon.svg">
<link rel="stylesheet" href="/public/css/globals.css">
<main class="container" style="padding:24px 0;max-width:820px">
  <h1 style="color:var(--veyra-primary);font-family:var(--veyra-font-head)">Proof</h1>
  <div id="box" class="card">Loading…</div>
</main>
<script>
function canon(o){ if(Array.isArray(o)) return o.map(canon);
  if(o&&typeof o==='object'){const r={};Object.keys(o).sort().forEach(k=>r[k]=canon(o[k]));return r} return o}
async function sha256Canonical(obj){
  const s=JSON.stringify(canon(obj)); const b=new TextEncoder().encode(s);
  const h=await crypto.subtle.digest('SHA-256',b);
  return Array.from(new Uint8Array(h)).map(x=>x.toString(16).padStart(2,'0')).join('')
}
(async()=>{
  const id=new URLSearchParams(location.search).get('id'); const box=document.getElementById('box');
  if(!id){ box.textContent='Missing ?id='; return; }
  const r=await fetch('/proofs/'+id); if(!r.ok){ box.textContent='Not found'; return; }
  const p=await r.json(); const copy=JSON.parse(JSON.stringify(p)); delete copy.sha256;
  const recalc=await sha256Canonical(copy); const ok=recalc===p.sha256;
  const art=(p.artifacts||[]).map(u=>`<a class="btn" href="${u}" target="_blank">${u.split('/').pop()}</a>`).join(' ') || '<span class="muted">—</span>';
  box.innerHTML = `
    <div style="display:flex;justify-content:space-between;gap:12px;align-items:center">
      <div>
        <div class="mono muted" style="font-size:12px">${new Date(p.timestamp).toLocaleString()}</div>
        <div style="font-weight:700">${p.title||p.id}</div>
        <div class="mono muted" style="font-size:12px">id=${p.id} · kind=${p.kind} · ttv=${p.ttv_sec??'—'}s</div>
      </div>
      <div style="font-size:14px">${ok?'✅ Verified':'❌ Mismatch'}</div>
    </div>
    <div class="card" style="background:#0b1020;margin-top:10px">
      <div class="mono" style="font-size:12px">sha256: ${p.sha256}</div>
    </div>
    <div style="margin-top:10px">${art}</div>`;
})();
</script>
